<!DOCTYPE html>

<head>

    <title>Choose your team</title>

    <!--Link CSS Reset-->
    <link rel="stylesheet" type="text/css" href=".\assets\css\reset.css">

    <!--Ajax Library-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript" src=".\assets\javascript\javascript.js"></script>

    <!--bootstrap-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

    <!--javascript-->
    <script type="text/javascript" src=".\assets\javascript\javascript.js"></script>

    <!--Link CSS-->
    <link rel="stylesheet" type="text/css" href=".\assets\css\styles.css">

</head>

<body class="text-center">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                    <h1>Choose Your Team</h1>
            </div>
        </div>
    </div>

    <!--Player Deck-->
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="panel-group">
                    <div class="panel panel-primary">
                        <div class="panel-heading text-left">Available Characters</div>
                        <div class="panel-body" id="deckContainer"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--Player hand-->
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="panel-group">
                    <div class="panel panel-primary">
                        <div class="panel-heading text-left">Cards in your Hand</div>
                        <div class="panel-body" id="playerHand"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--Modal Start-->
    <div class="container">

        <!-- Trigger the modal with a button -->
        <button type="button" class="btn btn-info btn-lg" id="submit">Battle!</button>

        <!-- Modal -->
        <div class="modal fade" id="myModal" role="dialog">
            <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Your need more cards</h4>
                    </div>
                    <div class="modal-body">
                        <p>Please select a total of 5 cards</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>

            </div>
        </div>

    </div>
    <!--Modal End-->

    <!--Modal Start-->
    <div class="container">

        <!-- Modal -->
        <div class="modal fade" id="myModal2" role="dialog">
            <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">To many cards</h4>
                    </div>
                    <div class="modal-body">
                        <p>You can only have 5 cards</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--Modal End-->
</body>

<script>
    var digmonNamesList = ["Agumon", "Gabumon", "Biyomon", "Tentomon", "Palmon", "Gomamon", "Patamon", "Elecmon", "Gazimon", "Otamamon", "Gotsumon"];
    var pokemonNamesList = ["Gyarados", "Magikarp", "Lugia", "Mew", "Mewtwo", "Gengar", "Eevee", "Jigglypuff", "Squirtle", "Charizard", "Pikachu"];
    var namesList = [];
    namesList = $.merge($.merge([], digmonNamesList), pokemonNamesList);
    var deck = [];


    function getImageDigimon(name) {
        //https://digimon-api.herokuapp.com/

        var queryURL = "https://digimon-api.herokuapp.com/api/digimon/name/" + name;
        $.ajax({
            url: queryURL,
            method: "GET"
        }).then(function (response) {
            var results = response[0]["img"];
            $("#" + name).attr("src", results);
        });

    }

    function getImagePokemon(name) {
        //https://pokeapi.co/
        var queryURL = "https://pokeapi.co/api/v2/pokemon/" + name + "/";
        $.ajax({
            url: queryURL,
            method: "GET"
        }).then(function (response) {
            var results = response.sprites["front_default"];
            $("#" + name).attr("src", results);

        });

    }

    function createDeck(name) {
        var card = $("<img height='100' width='100'>");
        var cardHolder = $("<div>");
        $(cardHolder).addClass("d-inline-block")
        $(card).addClass("d-block")
        $(cardHolder).addClass("cardHolder")
        $(cardHolder).attr("card-name", name);
        $(cardHolder).attr("location", "deck");
        $(card).attr("src", "https://via.placeholder.com/100");
        $(card).attr('id', name.toLowerCase());
        if (jQuery.inArray(name, pokemonNamesList) !== -1) {
            getImagePokemon(name.toLowerCase());
        }
        if (jQuery.inArray(name, digmonNamesList) !== -1) {
            getImageDigimon(name.toLowerCase());
        }
        $(cardHolder).append(card);
        $(cardHolder).append(name);
        $("#deckContainer").append(cardHolder).append(" ");
    }

    for (var name in namesList) {
        createDeck(namesList[name]);
    }


    $(".cardHolder").on("click", function () {

        if ($(this).attr("location") === "deck") {
            if (deck.length < 5) {
                $("#playerHand").append(this).append(" ");
                $(this).attr("location", "hand");
                deck.push($(this).attr("card-name"));
                console.log(deck);
            }
            else {
                $("#myModal2").modal();
            }

        }
        else {

            $("#deckContainer").append(this);
            $(this).attr("location", "deck");
            deck.splice($.inArray($(this).attr("card-name"), deck), 1);
            console.log(deck);
        }

    });
    $("#submit").on("click", function () {
        if (deck.length === 5) {
            localStorage.setItem("playerTeam", JSON.stringify(deck));
            location.href = "fight.html";
        }
        else {
            $("#myModal").modal();
        }

    });




</script>

</html>